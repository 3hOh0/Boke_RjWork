# DjangoBlog博客系统功能扩展
## 软件需求规格说明书

**项目名称**：DjangoBlog博客系统功能扩展  
**版本号**：V1.0  
**编写日期**：2024年X月X日  
**编写人员**：第X组全体成员

---

## 1. 引言

### 1.1 编写目的
本文档旨在详细描述DjangoBlog博客系统新增功能的需求规格，为开发团队提供清晰的功能定义和开发指导。

### 1.2 项目背景
DjangoBlog是一款基于Django 4.0的现代化博客系统。为满足课程项目需求，计划在现有系统基础上新增4个功能模块，提升系统的交互性和用户体验。

### 1.3 定义与缩写
- **PV**：Page View，页面浏览量
- **UV**：Unique Visitor，独立访客数
- **AJAX**：Asynchronous JavaScript and XML，异步JavaScript和XML

---

## 2. 项目概述

### 2.1 项目目标
- 增强博客系统的交互性和用户体验
- 提供更完善的内容管理和数据分析功能
- 提升系统的实用性和可维护性

### 2.2 用户特点
- **普通用户**：浏览文章、点赞、收藏、查看推荐
- **文章作者**：编辑文章、查看统计数据
- **管理员**：查看统计仪表盘、管理推荐配置

### 2.3 运行环境
- **操作系统**：Windows/Linux/MacOS
- **Python版本**：Python 3.10+
- **Django版本**：Django 4.0
- **数据库**：MySQL/SQLite
- **浏览器**：Chrome、Firefox、Edge等现代浏览器

---

## 3. 功能需求

### 3.1 功能1：读者互动增强（点赞/收藏）

#### 3.1.1 功能描述
为博客文章添加点赞和收藏功能，增强读者与内容的互动。

#### 3.1.2 功能需求

**3.1.2.1 点赞功能**
- 用户可以对文章进行点赞/取消点赞
- 显示文章总点赞数
- 防止重复点赞（同一用户对同一文章只能点赞一次）
- 支持AJAX异步操作，无需刷新页面
- 点赞排行榜页面（最受欢迎文章TOP20）
- 用户点赞历史记录查看
- 点赞通知功能（文章作者收到点赞邮件通知）

**3.1.2.2 收藏功能**
- 用户可以将文章添加到个人收藏夹
- 用户可以查看自己的收藏列表（分页显示）
- 支持取消收藏
- 显示文章总收藏数
- 收藏夹分类管理（创建、编辑、删除分类）
- 文章可添加到多个收藏夹分类
- 收藏文章搜索和筛选（按标题、分类、时间）

**3.1.2.3 我的收藏页面**
- 收藏列表展示（卡片式布局）
- 收藏分类筛选
- 收藏时间排序
- 批量删除收藏

#### 3.1.3 性能要求
- 点赞/收藏操作响应时间 < 200ms
- 支持并发操作，数据一致性保证

#### 3.1.4 接口需求
- POST /api/like/ - 点赞/取消点赞
- GET /api/favorites/ - 获取收藏列表
- POST /api/favorites/ - 添加收藏
- DELETE /api/favorites/{id}/ - 取消收藏

---

### 3.2 功能2：文章推荐模块

#### 3.2.1 功能描述
基于文章标签、分类和内容相似度，为读者推荐相关文章。

#### 3.2.2 功能需求

**3.2.2.1 相似文章推荐**
- 在文章详情页显示"相关文章"模块
- 基于标签匹配度推荐相似文章（计算共同标签数量）
- 基于分类推荐同类别文章
- 显示推荐文章列表（默认5篇）
- 基于文章标题关键词匹配推荐

**3.2.2.2 推荐算法**
- 标签匹配算法：计算两篇文章的共同标签数，标签越多越相似
- 分类匹配算法：同一分类下的文章优先推荐
- 时间权重：优先推荐较新的文章（最近3个月）
- 热度权重：浏览量高的文章优先推荐
- 综合评分：标签匹配度 + 分类匹配度 + 时间权重 + 热度权重

**3.2.2.3 推荐展示**
- 在文章详情页底部展示"相关文章"模块
- 显示文章标题、摘要、发布时间、浏览量
- 支持点击跳转到推荐文章详情
- 卡片式布局，美观易读

**3.2.2.4 推荐管理（可选）**
- 管理员可手动指定推荐文章（置顶推荐）
- 推荐数量配置（3-10篇可调）

#### 3.2.3 性能要求
- 推荐文章计算时间 < 100ms（使用缓存）
- 推荐文章结果缓存1小时

---

### 3.3 功能3：内容统计仪表盘

#### 3.3.1 功能描述
为管理员提供可视化的数据统计仪表盘，展示博客的关键运营指标。

#### 3.3.2 功能需求

**3.3.2.1 数据统计指标**
- 基础统计：文章总数、已发布文章数、草稿数
- 访问统计：总浏览量（PV）、独立访客数（UV）
- 互动统计：评论总数、点赞总数、收藏总数
- 用户统计：用户注册数、活跃用户数（最近30天）
- 排行榜：热门文章TOP10、热门作者TOP10
- 趋势分析：最近7天/30天的数据趋势

**3.3.2.2 数据可视化**
- 折线图：展示访问量趋势（7天/30天）
- 柱状图：展示文章发布趋势、分类分布
- 饼图：展示分类分布、标签分布
- 数字卡片：展示关键指标（大数字显示）

**3.3.2.3 统计页面布局**
- 顶部：关键指标卡片（4-6个）
- 中部：趋势图表（折线图、柱状图）
- 底部：排行榜表格（热门文章、热门作者）

**3.3.2.4 权限控制**
- 仅管理员可访问统计仪表盘
- 使用Django权限系统进行访问控制

#### 3.3.3 性能要求
- 统计仪表盘页面加载时间 < 2s
- 统计数据缓存10分钟

---

### 3.4 功能4：文章自动保存

#### 3.4.1 功能描述
在文章编辑过程中自动保存草稿，防止因意外情况导致内容丢失。

#### 3.4.2 功能需求

**3.4.2.1 自动保存机制**
- 在文章编辑页面，每隔30秒自动保存一次
- 保存文章标题、正文内容到草稿字段
- 显示"已自动保存"提示信息（右上角提示）
- 支持手动触发保存（保存按钮）
- 保存失败时显示错误提示

**3.4.2.2 草稿管理**
- 在文章列表显示草稿状态标识（草稿标签）
- 支持从草稿恢复编辑（点击编辑按钮）
- 显示最后保存时间（"最后保存：2024-01-01 12:00"）
- 区分自动保存和手动保存（显示保存类型）

**3.4.2.3 版本历史（简化版）**
- 保留最近5个自动保存版本
- 支持查看历史版本列表（时间倒序）
- 支持恢复到指定版本（一键恢复）
- 显示版本保存时间

**3.4.2.4 前端交互**
- 使用JavaScript定时器实现自动保存（setInterval）
- AJAX异步提交，不中断用户编辑
- 保存成功后显示提示（绿色提示框），失败时显示错误信息（红色提示框）
- 页面关闭前检测是否有未保存内容（beforeunload事件）
- 版本历史查看界面（弹窗或侧边栏）

#### 3.4.3 性能要求
- 自动保存操作不阻塞用户编辑
- 保存响应时间 < 500ms

---

## 4. 非功能性需求

### 4.1 性能需求
- 页面响应时间 < 2s
- 支持并发用户数 > 100
- 数据库查询优化，避免N+1问题

### 4.2 安全需求
- 所有用户操作需进行权限验证
- 防止CSRF攻击
- 防止SQL注入和XSS攻击
- 用户输入数据需进行验证和过滤

### 4.3 兼容性需求
- 兼容现有DjangoBlog系统架构
- 不影响现有功能正常使用
- 支持现有插件系统
- 兼容主流浏览器（Chrome、Firefox、Edge）

### 4.4 可维护性需求
- 代码遵循PEP8规范
- 函数和类要有清晰的注释
- 模块化设计，便于维护和扩展

---

## 5. 数据需求

### 5.1 数据模型

**Like模型**（点赞记录）
- id: 主键
- user: 用户（外键）
- article: 文章（外键）
- created_at: 创建时间

**Favorite模型**（收藏记录）
- id: 主键
- user: 用户（外键）
- article: 文章（外键）
- category: 收藏分类（外键）
- created_at: 创建时间

**FavoriteCategory模型**（收藏分类）
- id: 主键
- user: 用户（外键）
- name: 分类名称
- created_at: 创建时间

**ArticleDraft模型**（文章草稿）
- id: 主键
- article: 文章（外键）
- title: 标题
- content: 内容
- save_type: 保存类型（自动/手动）
- created_at: 创建时间

---

## 6. 界面需求

### 6.1 界面设计原则
- 简洁美观，符合现代Web设计风格
- 响应式设计，适配不同屏幕尺寸
- 交互友好，操作直观

### 6.2 主要界面

**6.2.1 文章详情页**
- 添加点赞按钮和收藏按钮
- 底部显示"相关文章"推荐模块

**6.2.2 我的收藏页面**
- 收藏列表展示
- 收藏分类管理
- 搜索筛选功能

**6.2.3 统计仪表盘页面**
- 关键指标卡片
- 数据可视化图表
- 排行榜表格

**6.2.4 文章编辑页面**
- 自动保存提示
- 版本历史查看
- 草稿恢复功能

---

## 7. 团队成员分工

| 成员 | 负责功能 | 预计代码量 |
|------|---------|-----------|
| 成员1 | 读者互动增强（点赞/收藏） | 2,500行 |
| 成员2 | 文章推荐模块 | 2,500行 |
| 成员3 | 内容统计仪表盘 | 2,500行 |
| 成员4 | 文章自动保存 | 2,500行 |

---

## 8. 开发计划

### 8.1 开发阶段
- **第一阶段**：数据库设计和模型创建（1周）
- **第二阶段**：核心功能开发（2周）
- **第三阶段**：测试和Bug修复（1周）
- **第四阶段**：文档编写和项目总结（1周）

### 8.2 里程碑
- 需求分析完成
- 数据库设计完成
- 核心功能开发完成
- 测试完成
- 项目交付

---

## 9. 验收标准

### 9.1 功能验收
- 所有功能模块按需求文档实现
- 功能测试通过率 100%
- 无明显Bug和性能问题

### 9.2 代码质量
- 代码符合PEP8规范
- 通过SonarQube代码质量检测
- 代码注释完整，可维护性良好

---

**文档编写人**：第X组全体成员  
**审核人**：XXX  
**批准人**：XXX  
**日期**：2024年X月X日

